# Playwright + Cucumber UI Automation Framework

This project implements UI automation for the [SauceDemo](https://www.saucedemo.com) website using **Playwright**, **TypeScript**, and **Cucumber (Gherkin)**. It follows a modular structure using the **Page Object Model (POM)** and supports tagging, reporting, and CI/CD integration.

---

## Project Structure

```
pw/
â”œâ”€â”€ features/              # Gherkin .feature files
â”‚                          # Contains Cucumber feature files written in Gherkin syntax, describing the test scenarios
â”‚   â”œâ”€â”€ login.feature
â”‚   â””â”€â”€ checkout.feature
â”œâ”€â”€ pages/                 # Page Object Model classes
â”‚   â”œâ”€â”€                    # Implements the Page Object Model, encapsulating web page elements and actions for reusability
â”‚   â”œâ”€â”€ PageBase.ts
â”‚   â”œâ”€â”€ LoginPage.ts
â”‚   â”œâ”€â”€ InventoryPage.ts
â”‚   â”œâ”€â”€ CartPage.ts
â”‚   â”œâ”€â”€ CheckoutPage.ts
â”‚   â”œâ”€â”€ ConfirmationPage.ts
â”‚   â”‚                      # .json files that contain key: value formated data related to the pages endpoint for navigation porpuses and all the string selectors (DOM)
â”‚   â”œâ”€â”€ pages.json
â”‚   â”œâ”€â”€ selectors.json
â”œâ”€â”€ step-definitions/      # Step bindings (Cucumber + Playwright)
â”‚   â”œâ”€â”€                    # Houses the step definition files that map Gherkin steps to executable code
â”‚   â”œâ”€â”€ login.steps.ts
â”‚   â”œâ”€â”€ checkout.steps.ts
â”‚   â””â”€â”€ hooks.ts
â”œâ”€â”€ reports/               # HTML and JSON reports
â”œâ”€â”€ test-results/          # Screenshots, traces, videos
â”œâ”€â”€ .env                   # Environment variables (e.g., BASE_URL) 
â”‚                          # Stores environment variables such as URLs, credentials, and configuration settings
â”œâ”€â”€ cucumber.js            # Cucumber config
â”œâ”€â”€ playwright.config.ts   # Playwright runner configuration
â”œâ”€â”€ package.json           # Project metadata and scripts
â””â”€â”€ README.md              # Project documentation
```

---

## ðŸš€ Getting Started

### 1. Install Dependencies
```bash
npm install
```

### 2. Run All Tests (Headless)
```bash
npm test
```
### 3. Run an Specific Given Test
```bash
npm run test:single ""Scenario Title"
```
### 4. Run Specific Tagged Tests
```bash
npm run test:smoke
npm run test:regression
npm run test:flaky
```

### 5. Run in Headed Mode for Debugging
Edit each step-definition file file and set:
```ts
browser = await chromium.launch({ headless: false, slowMo: 200 });
```

---

## âœ… Available Scripts (package.json)

```json
  "scripts": {
    "test": "npx cucumber-js",
    "test:single": "npx cucumber-js --name",
    "test:smoke": "npx cucumber-js --tags @smoke",
    "test:regression": "npx cucumber-js --tags @regression",
    "test:flaky": "npx cucumber-js --tags @flaky --retry 2",
    "report": "node report.js",
    "test:report": "npx cucumber-js --format json:reports/cucumber_report.json && node report.js"
  }
```

---

## ðŸ§ª Test Examples

### Login Flow
**gherkin**
  Scenario: Successful login with valid credentials
    Given I open the login page
    When I log in with "standard_user" and "secret_sauce" 
    Then I land on the inventory page and see at least one product
  
  Scenario: Try to login with locked out user
    Given I open the login page
    When I log in with "locked_out_user" and "secret_sauce"
    Then I should see the error message "Sorry, this user has been locked out."

### Checkout Flow
**gherkin**
  Scenario: Successful checkout flow
    Given I am logged in as a "standard user"
    When I add any product to the cart
    And I fill First Name, Last Name, Postal Code with any valid values
    And I complete the checkout
    Then I see the "Thank you for your order!" confirmation

  Scenario: Form validation shows error when required field is missing
    Given I am at "Checkout: Your Information"
    When I leave the "Postal Code" empty and click "Continue"
    Then I see the error message about the missing field

---

## Reporting

### Generate HTML Report:
```bash
npm run test:report
```

Outputs to:
- `reports/cucumber_report.json`
- `reports/html/`

An example report summarizing the results of a full regression execution is available in the report-result-sample directory. It can be generated by running the following command:
```bash
start report-result-sample/html/index.html
```
---

## Playwright Artifacts

- Screenshots, videos, and traces are automatically saved in:
  - `test-results/`
  - `playwright-report/`

---

## Environment Variables

Add a `.env` file in the root:
```
BASE_URL=https://www.saucedemo.com
```

These values are injected into step definitions using `process.env`.

---

## CI/CD

This project supports:
- GitHub Actions integration
- Tagged test execution (`@smoke`, `@regression`, `@flaky`)
- Retry logic and trace collection for failed tests

To reduce flakiness and improve test reliability in CI/CD pipelines:

- **Retries**: Use the `--retry` flag with Cucumber (`npm run test:flaky`) to re-attempt flaky scenarios.
- **Screenshots & Videos**: Automatically captured on failure (stored in `test-results/` or `playwright-report/`).
- **Headless Stability**: Tests are optimized to run in headless environments using smart selectors and built-in waits.
- **Parallel Execution**: Can be enabled via Playwright config to run tests concurrently for faster CI runs.

These features help debug and stabilize tests in both local and remote CI environments.